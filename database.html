<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RNA Pathology â€” Database</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; }
    h1 { margin: 0 0 10px 0; }
    p { margin: 0 0 18px 0; color: #444; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 14px; }
    .card { border: 1px solid #ddd; border-radius: 10px; overflow: hidden; background: #fff; }
    .card img { width: 100%; height: auto; display: block; }
    .cap { padding: 10px 12px; font-size: 13px; color: #333; border-top: 1px solid #eee; word-break: break-all; }
    .hint { font-size: 12px; color: #666; margin-top: 14px; }
    a { text-decoration: none; color: inherit; }
  </style>
</head>
<body>
  <h1>Database</h1>
  <p>Images from <code>assets/database/</code> (auto-synced). Click to open full size.</p>

  <div id="grid" class="grid"></div>
  <div class="hint" id="hint"></div>

  <script>
    // Change these only if you rename repo/owner:
    const owner = "hutaobo";
    const repo  = "rna-pathology";
    const dir   = "assets/database";

    const api = `https://api.github.com/repos/${owner}/${repo}/contents/${dir}`;

    function isJpg(name) {
      const n = name.toLowerCase();
      return n.endsWith(".jpg") || n.endsWith(".jpeg");
    }

    async function main() {
      const grid = document.getElementById("grid");
      const hint = document.getElementById("hint");

      try {
        const res = await fetch(api);
        if (!res.ok) throw new Error(`GitHub API error: ${res.status}`);
        const items = await res.json();

        const imgs = items
          .filter(x => x.type === "file" && isJpg(x.name))
          .sort((a,b) => a.name.localeCompare(b.name));

        if (imgs.length === 0) {
          hint.textContent = "No .jpg/.jpeg found in assets/database.";
          return;
        }

        hint.textContent = `Found ${imgs.length} image(s).`;

        for (const f of imgs) {
          const a = document.createElement("a");
          a.href = f.download_url;         // full-res
          a.target = "_blank";
          a.rel = "noopener";

          const card = document.createElement("div");
          card.className = "card";

          const img = document.createElement("img");
          img.src = f.download_url;        // preview (same as full-res)
          img.alt = f.name;
          img.loading = "lazy";

          const cap = document.createElement("div");
          cap.className = "cap";
          cap.textContent = f.name;

          card.appendChild(img);
          card.appendChild(cap);
          a.appendChild(card);
          grid.appendChild(a);
        }
      } catch (e) {
        hint.textContent = "Failed to load images. " + e.message;
      }
    }

    main();
  </script>
</body>
</html>
